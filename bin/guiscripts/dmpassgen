#!/usr/bin/env sh
choice="$(echo "multiline\nsingle" | dmenu -l 1 -g 2)"
test -z "${choice}" && exit 1

password="$(dmenu -p "name:" </dev/null)"
test -z "${password}" && exit 1

if [ "${choice}" = "multiline" ]
then
	login="$(ls -1 ~/.password-store/e-mails |
		sed 's/\.gpg$//' | 
		dmenu -g 1 -l 8 -p "login:")"
    test -z "${login}" && exit 1
    url="$(dmenu -p "url:" </dev/null)"
    test -z "${url}" && exit 1
    echo "${password}\nlogin: ${login}\nurl: ${url}" |
		pass insert -mf "${password}"
    pass generate -ci "${password}"
else
    pass generate -cf "${password}"
fi

