#!/usr/bin/env bash

find ${1:-~/movies ~/Downloads} 2> /dev/null | grep -E ".+\.(webm|mp4|mpeg|mkv)$" | sort > /tmp/dmvids
choice="$(\
        sed 's|^/home/aluc|\~| ; s|\([^/]\)[^/]*/|\1/|g' /tmp/dmvids \
        | tr '\n' '\0' \
        | xargs -0 -I {} echo "ï€½ {}" \
        | tr '\0' '\n' \
		| awk '{printf "%-3s %s\n", NR ":", $0}' \
        | dmenu -l 10 -g 1 -x -i \
		| grep -zoE "^[0-9]+:" \
)"
if [ -z "$choice" ]; then
	exit
fi
vid="$(sed -n "${choice::-1}p" /tmp/dmvids)"
mpv "$vid"
